(()=>{"use strict";var e={792:(e,t,n)=>{n.r(t)},500:(e,t,n)=>{n.r(t)},85:(e,t,n)=>{n.r(t)},515:(e,t,n)=>{n.r(t)},41:(e,t,n)=>{n.r(t)},786:(e,t,n)=>{n.r(t)},577:(e,t,n)=>{n.r(t)},143:(e,t,n)=>{n.r(t)},66:(e,t,n)=>{n.r(t)},550:(e,t,n)=>{n.r(t)},275:(e,t,n)=>{n.r(t)},752:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0,n(792);const s=n(199),i=n(535),o=n(654);t.App=class{constructor(e){this.rootElement=e,this.garagePage=new i.Garage,this.winnersPage=new o.Winners;const t=new s.Header(e);e.append(this.garagePage.node),t.garageButton.node.addEventListener("click",(()=>this.changePage(this.garagePage))),t.winnersButton.node.addEventListener("click",(()=>{this.changePage(this.winnersPage),this.winnersPage.refreshTotalCount(),this.winnersPage.refreshPage()}))}changePage(e){var t;null===(t=this.rootElement.lastElementChild)||void 0===t||t.remove(),this.rootElement.append(e.node)}}},928:function(e,t){var n=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,o){function r(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}u((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncRaceApi=void 0,t.AsyncRaceApi=class{constructor(){this.baseUrl="http://localhost:3000"}getResponse(e,t="",s=-1){return n(this,void 0,void 0,(function*(){return yield fetch(`${this.baseUrl}/${e}/${s<0?"":s}?${t}`)}))}getTotalCount(e){return n(this,void 0,void 0,(function*(){const t=yield this.getResponse(e,"_limit=1");return Number(t.headers.get("X-Total-Count"))}))}getGarageCars(){return n(this,void 0,void 0,(function*(){const e=yield this.getResponse("garage");return yield e.json()}))}getGarageCar(e){return n(this,void 0,void 0,(function*(){const t=yield this.getResponse("garage","",e);return yield t.json()}))}postCar(e,t){return n(this,void 0,void 0,(function*(){yield fetch(`${this.baseUrl}/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}))}updateCar(e,t,s="garage"){return n(this,void 0,void 0,(function*(){yield fetch(`${this.baseUrl}/${s}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}))}deleteCar(e,t){return n(this,void 0,void 0,(function*(){yield fetch(`${this.baseUrl}/${t}/${e}`,{method:"DELETE"})}))}postGarageCar(e){return n(this,void 0,void 0,(function*(){yield this.postCar(e,"garage")}))}postWinner(e){return n(this,void 0,void 0,(function*(){yield this.postCar(e,"winners")}))}updateGarageCar(e,t){return n(this,void 0,void 0,(function*(){yield this.updateCar(e,t,"garage")}))}updateWinner(e,t){return n(this,void 0,void 0,(function*(){yield this.updateCar(e,t,"winners")}))}getPage(e,t,s,i=""){return n(this,void 0,void 0,(function*(){const n=`${i}_page=${t}&_limit=${s}`;return yield this.getResponse(e,n)}))}getGaragePage(e,t){return n(this,void 0,void 0,(function*(){const n=yield this.getPage("garage",e,t);return yield n.json()}))}startEngine(e){return n(this,void 0,void 0,(function*(){const t=`id=${e}&status=started`,n=yield this.getResponse("engine",t);return yield n.json()}))}stopEngine(e){return n(this,void 0,void 0,(function*(){const t=`id=${e}&status=stopped`;return yield this.getResponse("engine",t)}))}switchEngineToDriveMode(e){return n(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{const s=`id=${e}&status=drive`;this.getResponse("engine",s).then((e=>{500===e.status?n(e.status):t()}))}))}))}getWinners(){return n(this,void 0,void 0,(function*(){const e=yield this.getResponse("winners");return yield e.json()}))}getWinnersPage(e,t,s,i){return n(this,void 0,void 0,(function*(){const n=`_sort=${s}&_order=${i}&`,o=yield this.getPage("winners",e,t,n);return yield o.json()}))}}},963:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CarAdjust=void 0;const s=n(130),i=n(178),o=n(707),r=n(891);n(500);class a extends i.BaseComponent{constructor(e,t){super(e,"div","car-adjust"),this.textInput=new r.TextInput(this.node),this.colorInput=new o.ColorInput(this.node),this.submitButton=new s.BaseButton(this.node,t)}getInputValues(){return{name:this.textInput.getValue(),color:this.colorInput.getValue()}}resetInputs(){this.textInput.resetInput(),this.colorInput.resetInput()}setInputs(e,t){this.textInput.setValue(e),this.colorInput.setValue(t)}}t.CarAdjust=a},997:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CarControl=void 0;const s=n(130),i=n(178),o=n(881),r=n(840);n(85);class a extends i.BaseComponent{constructor(e,t){super(e,"div","car-control"),this.carInfo=t,this.car=new o.Car(this.node),this.delay=null,this.raceTime=0,this.carName=new i.BaseComponent(this.node,"div","car-control__car-name"),this.startButton=new s.BaseButton(this.node,"start"),this.stopButton=new s.BaseButton(this.node,"stop"),this.selectButton=new s.BaseButton(this.node,"select"),this.removeButton=new s.BaseButton(this.node,"remove"),this.buttonsArray=[this.startButton,this.stopButton,this.selectButton,this.removeButton],this.raceTrack=new r.RaceTrack(this.node),this.carName.node.innerText=t.name,this.car.setColor(this.carInfo.color),this.stopButton.toggleButtonMode()}getCarId(){return this.carInfo.id}runCar(){this.car.setTransitionTime(`${this.raceTime}ms`),this.car.moveCar()}returnBackCar(){this.resetTransitionTime(),this.car.returnBackCar()}stopCar(){this.resetTransitionTime(),this.car.stopCar()}setDelay(){return new Promise((e=>{this.delay=setTimeout((()=>e(this)),this.raceTime)}))}clearDelay(){this.delay&&(clearTimeout(this.delay),this.delay=null)}setRaceTime(e){this.raceTime=e}getCarInfo(){return this.carInfo}resetTransitionTime(){this.car.setTransitionTime("0s")}toggleButtonsMode(e=!0){this.buttonsArray.forEach((t=>t.toggleButtonMode(e)))}getCarName(){return this.carInfo.name}getRaceTime(){return this.raceTime}}t.CarControl=a},881:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Car=void 0;const s=n(178);n(515);class i extends s.BaseComponent{constructor(e){super(e,"div","car")}setColor(e){this.node.style.backgroundColor=e}moveCar(){this.node.style.left="calc(100% - 120px)"}returnBackCar(){this.node.style.left="0"}stopCar(){this.node.style.left=`${this.node.getBoundingClientRect().left}px`}setTransitionTime(e){this.node.style.transitionDuration=e}}t.Car=i},930:function(e,t){var n=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,o){function r(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}u((s=s.apply(e,t||[])).next())}))};function s(){return Math.round(9*Math.random())}function i(){return Math.round(255*Math.random()).toString(16)}function o(e){const t=e[s()];return`${t.manufacturer} ${t.models[s()]}`}Object.defineProperty(t,"__esModule",{value:!0}),t.getCars=void 0,t.getCars=function(){return n(this,void 0,void 0,(function*(){const e=yield fetch("./car-models.json"),t=yield e.json();return[...new Array(100)].map((()=>({name:o(t),color:`#${i()}${i()}${i()}`})))}))}},707:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorInput=void 0;const s=n(677);n(41);class i extends s.BaseInput{constructor(e){super(e,"color-input"),this.inputNode.type="color",this.defaultValue="#000000"}}t.ColorInput=i},903:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GarageControl=void 0;const s=n(130),i=n(178),o=n(963);class r extends i.BaseComponent{constructor(e){super(),this.carAdjustCreate=new o.CarAdjust(this.node,"create"),this.carAdjustUpdate=new o.CarAdjust(this.node,"update"),this.raceButton=new s.BaseButton(this.node,"race"),this.resetButton=new s.BaseButton(this.node,"reset"),this.generateCarsButton=new s.BaseButton(this.node,"generate cars"),e.prepend(this.node)}toggleCarAdjustButtonsMode(e=!0){this.carAdjustCreate.submitButton.toggleButtonMode(e),this.carAdjustUpdate.submitButton.toggleButtonMode(e)}toggleRaceButtonMode(e=!0){this.raceButton.toggleButtonMode(e)}toggleResetButtonMode(e=!0){this.resetButton.toggleButtonMode(e)}toggleGenerateButtonMode(e=!0){this.generateCarsButton.toggleButtonMode(e)}toggleAllButtonsMode(e=!0){this.toggleCarAdjustButtonsMode(e),this.toggleGenerateButtonMode(e),this.toggleRaceButtonMode(e)}}t.GarageControl=r},669:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GarageCurrentPage=void 0;const s=n(178),i=n(997);class o extends s.BaseComponent{constructor(e,t=[]){super(e,"div","car-list__page"),this.carArray=[],this.initGarage(t)}addCar(e){const t=new i.CarControl(this.node,e);this.carArray.push(t)}initGarage(e){e.forEach((e=>this.addCar(e)))}getCarControls(){return this.carArray}}t.GarageCurrentPage=o},110:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GaragePageWrapper=void 0;const s=n(841),i=n(669);class o extends s.BasePageWrapper{constructor(){super(...arguments),this.carListPage=new i.GarageCurrentPage(this.node)}refreshCarListPage(e){var t;null===(t=this.node.lastElementChild)||void 0===t||t.remove(),this.carListPage=new i.GarageCurrentPage(this.node,e)}getCarControls(){return this.carListPage.getCarControls()}}t.GaragePageWrapper=o},199:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const s=n(130),i=n(178);class o extends i.BaseComponent{constructor(e){super(e,"header","header"),this.garageButton=new s.BaseButton(this.node,"to garage"),this.winnersButton=new s.BaseButton(this.node,"to winners")}}t.Header=o},53:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0;const s=n(130),i=n(178);n(786);class o extends i.BaseComponent{constructor(){super(null,"div","popup-wrapper"),this.popup=new i.BaseComponent(this.node,"div","popup"),this.messageField=new i.BaseComponent(this.popup.node,"div","popup__message-field"),this.background=new i.BaseComponent(this.node,"div","background"),this.confirmButton=new s.BaseButton(this.popup.node,"ok"),this.confirmButton.node.addEventListener("click",(()=>{var e;return null===(e=document.body.lastElementChild)||void 0===e?void 0:e.remove()})),this.background.node.addEventListener("click",(()=>{var e;return null===(e=document.body.lastElementChild)||void 0===e?void 0:e.remove()}))}setMessage(e){this.messageField.node.innerText=e}}t.Popup=o},840:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RaceTrack=void 0;const s=n(178);n(577);class i extends s.BaseComponent{constructor(e){super(e,"div","race-track"),this.finishFlag=new s.BaseComponent(this.node,"div","race-track__finish-flag")}}t.RaceTrack=i},891:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextInput=void 0;const s=n(677);class i extends s.BaseInput{constructor(e){super(e,"test-input"),this.inputNode.type="text"}}t.TextInput=i},254:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Title=void 0;const s=n(178);class i extends s.BaseComponent{constructor(e,t){super(e,"h2",`${t}__title`),this.totalCount=0,this.caption=t[0].toUpperCase()+t.slice(1),this.setTotalCount()}setTotalCount(e=0){this.totalCount=e,this.node.innerText=`${this.caption} (${this.totalCount})`}}t.Title=i},844:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Winner=void 0;const s=n(178);n(143);class i extends s.BaseComponent{constructor(e,t,n){super(e,"div","winner"),this.placeNumber=new s.BaseComponent(this.node,"div","winner__info winner__info_place-number"),this.car=new s.BaseComponent(this.node,"div","winner__info winner__info_car"),this.name=new s.BaseComponent(this.node,"div","winner__info winner__info_name"),this.numberOfWins=new s.BaseComponent(this.node,"div","winner__info winner__info_wins"),this.bestTime=new s.BaseComponent(this.node,"div","winner__info winner__info_time"),this.placeNumber.node.innerText=t.toString(),this.car.node.style.backgroundColor=n.color,this.name.node.innerText=n.name,this.numberOfWins.node.innerText=n.wins.toString(),this.bestTime.node.innerText=n.time.toString()}}t.Winner=i},581:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnersCurrentPage=void 0;const s=n(178),i=n(844);class o extends s.BaseComponent{constructor(e,t=1,n=[],s=10){super(e,"div","winners__current-page"),this.currentPageNumber=t,this.pageLimit=s,this.initWinners(n)}addWinner(e,t){return new i.Winner(this.node,e,t)}initWinners(e){let t=this.currentPageNumber*this.pageLimit-this.pageLimit;e.forEach((e=>{t++,this.addWinner(t,e)}))}}t.WinnersCurrentPage=o},499:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnersPageWrapper=void 0;const s=n(130),i=n(178),o=n(841),r=n(581);n(66);class a extends o.BasePageWrapper{constructor(e){super(e),this.buttonsWrapper=new i.BaseComponent(this.node,"div","buttons-wrapper"),this.placeNumber=new i.BaseComponent(this.buttonsWrapper.node,"div","button buttons-wrapper__place-number","№"),this.winnerCar=new i.BaseComponent(this.buttonsWrapper.node,"div","button buttons-wrapper__winner-car","car"),this.winnerName=new i.BaseComponent(this.buttonsWrapper.node,"div","button buttons-wrapper__winner-name","name"),this.sortWinsButton=new s.BaseButton(this.buttonsWrapper.node,"wins"),this.sortTimeButton=new s.BaseButton(this.buttonsWrapper.node,"best time"),this.winnersCurrentPage=new r.WinnersCurrentPage(this.node),this.sortWinsButton.node.classList.add("buttons-wrapper__winner-wins"),this.sortTimeButton.node.classList.add("buttons-wrapper__winner-time")}refreshCarListPage(e,t,n){var s;null===(s=this.node.lastElementChild)||void 0===s||s.remove(),this.winnersCurrentPage=new r.WinnersCurrentPage(this.node,t,e,n)}}t.WinnersPageWrapper=a},535:function(e,t,n){var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,o){function r(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}u((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Garage=void 0;const i=n(930),o=n(110),r=n(903),a=n(715);n(550);const u=n(53);class d extends a.BasePage{constructor(){super("garage"),this.garageControl=new r.GarageControl(this.node),this.currentCar=null,this.countSingleRaces=0,this.popup=new u.Popup,this.delay=void 0,this.pageLimit=7,this.carList=new o.GaragePageWrapper(this.node),this.garageControl.generateCarsButton.node.addEventListener("click",(()=>this.generateCars())),this.carList.nextPage.node.addEventListener("click",(()=>this.changePage())),this.carList.prevPage.node.addEventListener("click",(()=>this.changePage(!1))),this.garageControl.carAdjustCreate.submitButton.node.addEventListener("click",(()=>s(this,void 0,void 0,(function*(){yield this.createCar(),this.garageControl.carAdjustCreate.resetInputs()})))),this.garageControl.carAdjustUpdate.submitButton.node.addEventListener("click",(()=>s(this,void 0,void 0,(function*(){yield this.updateCar(),this.garageControl.carAdjustUpdate.resetInputs()})))),this.garageControl.resetButton.node.addEventListener("click",(()=>this.resetRace())),this.garageControl.raceButton.node.addEventListener("click",(()=>this.runRaceCycle())),this.garageControl.resetButton.toggleButtonMode(),this.refreshCurrentPage(),this.setLastPageNumber()}generateCars(){return s(this,void 0,void 0,(function*(){this.toggleAllButtonsMode();const e=yield i.getCars();yield Promise.all(e.map((e=>this.asyncRaceApi.postGarageCar(e)))),this.refreshTotalCount(),this.setLastPageNumber(),yield this.refreshCurrentPage(),this.toggleAllButtonsMode(!1)}))}changePage(e=!0){return s(this,void 0,void 0,(function*(){this.toggleAllButtonsMode(),this.setPageNumber(e),yield this.refreshCurrentPage(),this.toggleAllButtonsMode(!1)}))}refreshCurrentPage(){return s(this,void 0,void 0,(function*(){this.currentPage=yield this.asyncRaceApi.getGaragePage(this.pageNumber,this.pageLimit),this.carList.setPageNumberTitle(this.pageNumber),this.carList.refreshCarListPage(this.currentPage),this.observeCarControlButtons(),this.resetCountSingleRaces()}))}removeCar(e){return s(this,void 0,void 0,(function*(){this.toggleAllButtonsMode(),yield this.asyncRaceApi.deleteCar(e,this.pageName),yield this.asyncRaceApi.deleteCar(e,"winners"),this.refreshTotalCount(),yield this.refreshCurrentPage(),this.toggleAllButtonsMode(!1)}))}observeCarControlButtons(){this.carList.getCarControls().forEach((e=>{e.removeButton.node.addEventListener("click",(()=>this.removeCar(e.getCarId()))),e.selectButton.node.addEventListener("click",(()=>this.selectCar(e))),e.startButton.node.addEventListener("click",(()=>s(this,void 0,void 0,(function*(){return this.runSingleRace(e)})))),e.stopButton.node.addEventListener("click",(()=>this.stopSingleRace(e)))}))}createCar(){return s(this,void 0,void 0,(function*(){this.toggleAllButtonsMode();const e=this.garageControl.carAdjustCreate.getInputValues();yield this.asyncRaceApi.postGarageCar(e),this.refreshTotalCount(),yield this.refreshCurrentPage(),this.toggleAllButtonsMode(!1)}))}updateCar(){return s(this,void 0,void 0,(function*(){if(!this.currentCar)return;this.toggleAllButtonsMode();const e=this.garageControl.carAdjustUpdate.getInputValues();yield this.asyncRaceApi.updateGarageCar(e,this.currentCar),yield this.refreshCurrentPage(),this.currentCar=null,this.toggleAllButtonsMode(!1)}))}selectCar(e){return s(this,void 0,void 0,(function*(){this.toggleAllButtonsMode(),this.currentCar=e.getCarId();const t=yield this.asyncRaceApi.getGarageCar(this.currentCar);this.garageControl.carAdjustUpdate.setInputs(t.name,t.color),this.toggleAllButtonsMode(!1)}))}runCar(e){return s(this,void 0,void 0,(function*(){const t=e.getCarId(),n=yield this.getTime(t);e.setRaceTime(n)}))}stopCar(e){return s(this,void 0,void 0,(function*(){const t=e.getCarId();e.returnBackCar(),e.clearDelay(),yield this.asyncRaceApi.stopEngine(t)}))}switchEngineToDriveMode(e){return s(this,void 0,void 0,(function*(){const t=e.getCarId();return this.asyncRaceApi.switchEngineToDriveMode(t).catch((()=>{e.stopCar(),e.clearDelay()})),e.runCar(),yield e.setDelay()}))}resetRace(){return s(this,void 0,void 0,(function*(){this.garageControl.resetButton.toggleButtonMode(),this.toggleAllButtonsMode(),yield Promise.all(this.carList.getCarControls().map((e=>this.stopCar(e)))),this.toggleAllButtonsMode(!1)}))}startRace(){return s(this,void 0,void 0,(function*(){this.toggleAllButtonsMode();const e=this.carList.getCarControls();yield Promise.all(e.map((e=>this.runCar(e))));const t=yield Promise.race([...e.map((e=>this.switchEngineToDriveMode(e))),this.timeout(e.reduce(((e,t)=>t.getRaceTime()+e),0))]);if(this.garageControl.resetButton.toggleButtonMode(!1),t)return t}))}getTime(e){return s(this,void 0,void 0,(function*(){const t=yield this.asyncRaceApi.startEngine(e);return Math.round(t.distance/t.velocity)}))}runRaceCycle(){return s(this,void 0,void 0,(function*(){const e=yield this.startRace();if(e){const t=e.getRaceTime()/1e3,n=`${e.getCarName()} is went first (${t}s)`;this.popup.setMessage(n),this.refreshWinnersDatabase(e,t)}else{const e="All cars are broken";this.popup.setMessage(e)}document.body.append(this.popup.node)}))}refreshWinnersDatabase(e,t){return s(this,void 0,void 0,(function*(){const n=yield this.asyncRaceApi.getWinners(),s=e.getCarId(),i=n.find((({id:e})=>e===s));i?yield this.updateWinner(i,t,s):yield this.creatWinner(e,t)}))}updateWinner(e,t,n){return s(this,void 0,void 0,(function*(){e.wins++,e.time=e.time<t?e.time:t,yield this.asyncRaceApi.updateWinner(e,n)}))}creatWinner(e,t){return s(this,void 0,void 0,(function*(){const n={id:e.getCarId(),wins:1,time:t};yield this.asyncRaceApi.postWinner(n)}))}runSingleRace(e){return s(this,void 0,void 0,(function*(){this.countSingleRaces++,this.toggleGarageControlAndNavButtons(),e.toggleButtonsMode(),yield this.runCar(e),e.stopButton.toggleButtonMode(!1),this.switchEngineToDriveMode(e)}))}stopSingleRace(e){return s(this,void 0,void 0,(function*(){e.stopButton.toggleButtonMode(),yield this.stopCar(e),1===this.countSingleRaces&&this.toggleGarageControlAndNavButtons(!1),this.countSingleRaces--,e.toggleButtonsMode(!1),e.stopButton.toggleButtonMode()}))}toggleAllButtonsMode(e=!0){this.toggleGarageControlAndNavButtons(e),this.carList.getCarControls().forEach((t=>t.toggleButtonsMode(e))),e||this.toggleCarControlStopButtons()}toggleGarageControlAndNavButtons(e=!0){this.carList.toggleNavButtonsMode(e),this.garageControl.toggleAllButtonsMode(e)}toggleCarControlStopButtons(e=!0){this.carList.getCarControls().forEach((({stopButton:t})=>t.toggleButtonMode(e)))}resetCountSingleRaces(){this.countSingleRaces=0}timeout(e){return new Promise((t=>{this.delay||clearTimeout(this.delay),this.delay=setTimeout((()=>t()),e+100)}))}}t.Garage=d},654:function(e,t,n){var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,o){function r(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}u((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Winners=void 0;const i=n(499),o=n(715);class r extends o.BasePage{constructor(){super("winners"),this.winnersPageWrapper=new i.WinnersPageWrapper(this.node),this.winnersPage=[],this.sort="id",this.order="asc",this.pageLimit=10,this.pageNumber=1,this.refreshPage(),this.setLastPageNumber(),this.winnersPageWrapper.nextPage.node.addEventListener("click",(()=>this.changePage())),this.winnersPageWrapper.prevPage.node.addEventListener("click",(()=>this.changePage(!1))),this.winnersPageWrapper.sortWinsButton.node.addEventListener("click",(()=>this.changeSort("wins"))),this.winnersPageWrapper.sortTimeButton.node.addEventListener("click",(()=>this.changeSort("time")))}refreshPage(){return s(this,void 0,void 0,(function*(){this.toggleAllButtonsMode(),this.winnersPage=yield this.asyncRaceApi.getWinnersPage(this.pageNumber,this.pageLimit,this.sort,this.order);const e=yield Promise.all(this.winnersPage.map((e=>this.getFullCarInfo(e))));this.winnersPageWrapper.setPageNumberTitle(this.pageNumber),this.winnersPageWrapper.refreshCarListPage(e,this.pageNumber,this.pageLimit),this.toggleAllButtonsMode(!1)}))}getFullCarInfo({id:e,wins:t,time:n}){return s(this,void 0,void 0,(function*(){const{name:s,color:i}=yield this.asyncRaceApi.getGarageCar(e);return{id:e,name:s,color:i,wins:t,time:n}}))}changePage(e=!0){return s(this,void 0,void 0,(function*(){this.setPageNumber(e),yield this.refreshPage()}))}changeOrder(){this.order="asc"===this.order?"desc":"asc"}changeSort(e){return s(this,void 0,void 0,(function*(){this.sort===e?this.changeOrder():(this.sort=e,this.order="asc"),yield this.refreshPage()}))}toggleAllButtonsMode(e=!0){this.winnersPageWrapper.nextPage.toggleButtonMode(e),this.winnersPageWrapper.prevPage.toggleButtonMode(e),this.winnersPageWrapper.sortWinsButton.toggleButtonMode(e),this.winnersPageWrapper.sortTimeButton.toggleButtonMode(e)}}t.Winners=r},130:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseButton=void 0;const s=n(178);n(275);class i extends s.BaseComponent{constructor(e,t){super(e,"button","button",t)}toggleButtonMode(e=!0){this.node.classList.toggle("button_disable",e)}}t.BaseButton=i},178:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponent=void 0,t.BaseComponent=class{constructor(e=null,t="div",n="",s=""){const i=document.createElement(t);i.className=n,i.textContent=s,e&&e.append(i),this.node=i}}},677:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseInput=void 0;const s=n(178);class i extends s.BaseComponent{constructor(e,t){super(e,"input",t),this.defaultValue="",this.inputNode=this.node}getValue(){return this.inputNode.value}resetInput(){this.inputNode.value=this.defaultValue}setValue(e){this.inputNode.value=e}}t.BaseInput=i},841:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BasePageWrapper=void 0;const s=n(130),i=n(178);class o extends i.BaseComponent{constructor(e){super(e,"div","page-wrapper"),this.pageNumberTitle=new i.BaseComponent(this.node,"h3","","Page #1"),this.prevPage=new s.BaseButton(this.node,"prev"),this.nextPage=new s.BaseButton(this.node,"next")}setPageNumberTitle(e){this.pageNumberTitle.node.innerText=`Page #${e}`}toggleNavButtonsMode(e=!0){this.prevPage.toggleButtonMode(e),this.nextPage.toggleButtonMode(e)}}t.BasePageWrapper=o},715:function(e,t,n){var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,o){function r(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}u((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BasePage=void 0;const i=n(928),o=n(178),r=n(254);class a extends o.BaseComponent{constructor(e){super(null,"main",e),this.pageName=e,this.pageNumber=1,this.pageLimit=1,this.lastPageNumber=1,this.currentPage=[],this.asyncRaceApi=new i.AsyncRaceApi,this.title=new r.Title(this.node,this.pageName),this.refreshTotalCount()}refreshTotalCount(){return s(this,void 0,void 0,(function*(){const e=(yield this.asyncRaceApi.getTotalCount(this.pageName))||0;this.title.setTotalCount(e)}))}setPageNumber(e){const t=e?this.pageNumber+1:this.pageNumber-1;t<1||t>this.lastPageNumber||(this.pageNumber=t)}setLastPageNumber(){return s(this,void 0,void 0,(function*(){const e=yield this.asyncRaceApi.getTotalCount(this.pageName);e&&(this.lastPageNumber=Math.ceil(e/this.pageLimit))}))}}t.BasePage=a}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,n),o.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=n(752);document.addEventListener("DOMContentLoaded",(()=>new e.App(document.body)))})()})();